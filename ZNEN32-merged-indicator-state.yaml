blueprint:
  name: ZEN32 LED state -- merged
  description: For Zooz ZEN32. Sets the indicator color when linked entities are off, on or unavailable.  4.2024.51
  input:
    zooz_switch:
      name: Zooz Switch
      description: List of available Zooz ZEN32 switches.
      selector:
        device:
          filter:
            - integration: zwave_js
              manufacturer: Zooz
              model: ZEN32
            - integration: zwave_js
              manufacturer: Zooz
              model: ZEN32 800LR
          multiple: false
    input_entity0:
      name: Entity for button 1 (Big button)
      description: The entity to track
      default: []
      selector:
        entity:
          domain:
          - fan
          - light
          - media_player
          - sensor
          - switch
          multiple: false
    off_state0:
      name: Off behavior for button 1
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    off_color0:
      name: Off color for button 1
      description: Color for led when target is off (default white)
      default: '0'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    on_state0:
      name: On behavior for button 1
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    on_color0:
      name: On color for button 1
      description: Color for led when target is on (default white)
      default: '1'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    unavail_state0:
      name: Unavailable State for button 1
      description: Led state when target is unavailable
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    unavail_color0:
      name: Unavailable Color for button 1
      description: Color for led when target is unavailable (default red)
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    input_entity1:
      name: Entity for button 2 (Top left button)
      description: The entity to track
      default: []
      selector:
        entity:
          domain:
          - fan
          - light
          - media_player
          - sensor
          - switch
          multiple: false
    off_state1:
      name: Off behavior for button 2
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    off_color1:
      name: Off color for button 2
      description: Color for led when target is off (default white)
      default: '0'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    on_state1:
      name: On behavior for button 2
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    on_color1:
      name: On color for button 2
      description: Color for led when target is on (default white)
      default: '2'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    unavail_state1:
      name: Unavailable State for button 2
      description: Led state when target is unavailable
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    unavail_color1:
      name: Unavailable Color for button 2
      description: Color for led when target is unavailable (default red)
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    input_entity2:
      name: Entity for button 3 (Top right button)
      description: The entity to track
      default: []
      selector:
        entity:
          domain:
          - fan
          - light
          - media_player
          - sensor
          - switch
          multiple: false
    off_state2:
      name: Off behavior for button 3
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    off_color2:
      name: Off color for button 3
      description: Color for led when target is off (default white)
      default: '0'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    on_state2:
      name: On behavior for button 3
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    on_color2:
      name: On color for button 3
      description: Color for led when target is on (default white)
      default: '2'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    unavail_state2:
      name: Unavailable State for button 3
      description: Led state when target is unavailable
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    unavail_color2:
      name: Unavailable Color for button 3
      description: Color for led when target is unavailable (default red)
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    input_entity3:
      name: Entity for button 4 (Bottom left button)
      description: The entity to track
      default: []
      selector:
        entity:
          domain:
          - fan
          - light
          - media_player
          - sensor
          - switch
          multiple: false
    off_state3:
      name: Off behavior for button 4
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    off_color3:
      name: Off color for button 4
      description: Color for led when target is off (default white)
      default: '0'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    on_state3:
      name: On behavior for button 4
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    on_color3:
      name: On color for button 4
      description: Color for led when target is on (default white)
      default: '2'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    unavail_state3:
      name: Unavailable State for button 4
      description: Led state when target is unavailable
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    unavail_color3:
      name: Unavailable Color for button 4
      description: Color for led when target is unavailable (default red)
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    input_entity4:
      name: Entity for button 5 (Bottom right button)
      description: The entity to track
      default: []
      selector:
        entity:
          domain:
          - fan
          - light
          - media_player
          - sensor
          - switch
          multiple: false
    off_state4:
      name: Off behavior for button 5
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    off_color4:
      name: Off color for button 5
      description: Color for led when target is off (default white)
      default: '0'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    on_state4:
      name: On behavior for button 5
      description: Led state when target is off
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    on_color4:
      name: On color for button 5
      description: Color for led when target is on (default white)
      default: '2'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'
    unavail_state4:
      name: Unavailable State for button 5
      description: Led state when target is unavailable
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: Led On
              value: '3'
            - label: Led Off
              value: '2'
    unavail_color4:
      name: Unavailable Color for button 5
      description: Color for led when target is unavailable (default red)
      default: '3'
      selector:
        select:
          mode: dropdown
          options:
            - label: White
              value: '0'
            - label: Blue
              value: '1'
            - label: Green
              value: '2'
            - label: Red
              value: '3'
            - label: Magenta
              value: '4'
            - label: Yellow
              value: '5'
            - label: Cyan
              value: '6'

mode: parallel
max: 5
variables:
  controller_id: !input 'zooz_switch'
  toggle_offset: 1
  color_offset: 6
  targets:
    0:
      button_id: 0
      off_state: !input 'off_state0'
      off_color: !input 'off_color0'
      on_state: !input 'on_state0'
      on_color: !input 'on_color0'
      unavail_state: !input 'unavail_state0'
      unavail_color: !input 'unavail_color0'
    1:
      button_id: 1
      off_state: !input 'off_state1'
      off_color: !input 'off_color1'
      on_state: !input 'on_state1'
      on_color: !input 'on_color1'
      unavail_state: !input 'unavail_state1'
      unavail_color: !input 'unavail_color1'
    2:
      button_id: 2
      off_state: !input 'off_state2'
      off_color: !input 'off_color2'
      on_state: !input 'on_state2'
      on_color: !input 'on_color2'
      unavail_state: !input 'unavail_state2'
      unavail_color: !input 'unavail_color2'
    3:
      button_id: 3
      off_state: !input 'off_state3'
      off_color: !input 'off_color3'
      on_state: !input 'on_state3'
      on_color: !input 'on_color3'
      unavail_state: !input 'unavail_state3'
      unavail_color: !input 'unavail_color3'
    4:
      button_id: 4
      off_state: !input 'off_state4'
      off_color: !input 'off_color4'
      on_state: !input 'on_state4'
      on_color: !input 'on_color4'
      unavail_state: !input 'unavail_state4'
      unavail_color: !input 'unavail_color4'

trigger:
  - alias: DeviceStateTrigger0
    platform: state
    id: 0
    entity_id:
    - !input 'input_entity0'
  - alias: DeviceStateTrigger1
    platform: state
    id: 1
    entity_id:
    - !input 'input_entity1'
  - alias: DeviceStateTrigger2
    platform: state
    id: 2
    entity_id:
    - !input 'input_entity2'
  - alias: DeviceStateTrigger3
    platform: state
    id: 3
    entity_id:
    - !input 'input_entity3'
  - alias: DeviceStateTrigger4
    platform: state
    id: 4
    entity_id:
    - !input 'input_entity4'

action:
  - choose:
    - conditions: '{{ is_state(trigger.entity_id, ''off'') }}' # switch off
      sequence:
        - parallel:
          - service: zwave_js.set_config_parameter # turn indicator on/off
            data:
              parameter: '{{ (targets[trigger.idx].button_id | int) + (toggle_offset | int) }}'
              value: '{{ targets[trigger.idx].off_state }}'
            target:
              device_id: '{{ controller_id }}'
          - service: zwave_js.set_config_parameter # set indicator color
            data:
              parameter: '{{ (targets[trigger.idx].button_id | int) + (color_offset | int) }}'
              value: "{{ targets[trigger.idx].off_color }}"
            target:
              device_id: '{{ controller_id }}'
    - conditions: '{{ is_state(trigger.entity_id, ''on'') }}' # switch on
      sequence:
        - parallel:
          - service: zwave_js.set_config_parameter # turn indicator on/off
            data:
              parameter: '{{ (targets[trigger.idx].button_id | int) + (toggle_offset | int) }}'
              value: "{{ targets[trigger.idx].on_state }}"
            target: 
              device_id: '{{ controller_id }}'
          - service: zwave_js.set_config_parameter # set indicator color
            data:
              parameter: '{{ (targets[trigger.idx].button_id | int) + (color_offset | int) }}'
              value: "{{ targets[trigger.idx].on_color }}"
            target:
              device_id: '{{ controller_id }}'
    - conditions: '{{ is_state(trigger.entity_id, ''unavailable'') }}' # switch unavailable
      sequence:
        - parallel:
          - service: zwave_js.set_config_parameter # turn indicator on/off
            data:
              parameter: '{{ (targets[trigger.idx].button_id | int) + (toggle_offset | int) }}'
              value: '{{ targets[trigger.idx].unavail_state }}'
            target: 
              device_id: '{{ controller_id }}'
          - service: zwave_js.set_config_parameter # set indicator color
            data:
              parameter: '{{ (targets[trigger.idx].button_id | int) + (color_offset | int) }}'
              value: '{{ targets[trigger.idx].unavail_color }}'
            target:
              device_id: '{{ controller_id }}'